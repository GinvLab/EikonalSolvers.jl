<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · EikonalSolvers.jl</title><meta name="title" content="API · EikonalSolvers.jl"/><meta property="og:title" content="API · EikonalSolvers.jl"/><meta property="twitter:title" content="API · EikonalSolvers.jl"/><meta name="description" content="Documentation for EikonalSolvers.jl."/><meta property="og:description" content="Documentation for EikonalSolvers.jl."/><meta property="twitter:description" content="Documentation for EikonalSolvers.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EikonalSolvers.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Cartesian/spherical-grids-structures"><span>Cartesian/spherical grids structures</span></a></li><li><a class="tocitem" href="#Forward,-gradient-and-misfit-calculation-functions"><span>Forward, gradient and misfit calculation functions</span></a></li><li><a class="tocitem" href="#Extra-parameters"><span>Extra parameters</span></a></li><li><a class="tocitem" href="#Ray-tracing"><span>Ray tracing</span></a></li><li><a class="tocitem" href="#HMCsampler-wrapper"><span>HMCsampler wrapper</span></a></li><li><a class="tocitem" href="#Extensions"><span>Extensions</span></a></li></ul></li><li><a class="tocitem" href="../privatestuff/">Private stuff</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GinvLab/EikonalSolvers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/main/docs/src/publicapi.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API,-exported-functions"><a class="docs-heading-anchor" href="#API,-exported-functions">API, exported functions</a><a id="API,-exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#API,-exported-functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.EikonalSolvers" href="#EikonalSolvers.EikonalSolvers"><code>EikonalSolvers.EikonalSolvers</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>EikonalSolvers</p><p>EikonalSolvers module, 2D and 3D traveltime and gradient computations in Cartesian   and spherical coordinates.  Computes seismic traveltimes by solving the eikonal equation in two and three dimensions with the possibility of computing the gradient of the misfit function with respect to the velocity model.   Both forward and gradient computations are parallelised using Julia&#39;s distributed computing functions and the parallelisation is &quot;by source&quot;, distributing calculations for different sources to different processors.</p><p><strong>Exports</strong></p><ul><li><a href="#EikonalSolvers.HMCtraveltimes.EikonalProbSrcLoc"><code>EikonalProbSrcLoc</code></a></li><li><a href="#EikonalSolvers.HMCtraveltimes.EikonalProbVel"><code>EikonalProbVel</code></a></li><li><a href="@ref"><code>EikonalProbVelAndSrcLoc</code></a></li><li><a href="#EikonalSolvers.ExtraParams"><code>ExtraParams</code></a></li><li><a href="#EikonalSolvers.Grid2DCart"><code>Grid2DCart</code></a></li><li><a href="#EikonalSolvers.Grid2DSphere"><code>Grid2DSphere</code></a></li><li><a href="#EikonalSolvers.Grid3DCart"><code>Grid3DCart</code></a></li><li><a href="#EikonalSolvers.Grid3DSphere"><code>Grid3DSphere</code></a></li><li><a href="#EikonalSolvers.GridRefinementPars"><code>GridRefinementPars</code></a></li><li><a href="#EikonalSolvers.eikgradient"><code>eikgradient</code></a></li><li><a href="#EikonalSolvers.eiktraveltime"><code>eiktraveltime</code></a></li><li><a href="#EikonalSolvers.eikttimemisfit"><code>eikttimemisfit</code></a></li><li><a href="#EikonalSolvers.savemodelvtk"><code>savemodelvtk</code></a></li><li><a href="#EikonalSolvers.tracerays"><code>tracerays</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikonalSolvers.jl#L8-L20">source</a></section></article><h2 id="Cartesian/spherical-grids-structures"><a class="docs-heading-anchor" href="#Cartesian/spherical-grids-structures">Cartesian/spherical grids structures</a><a id="Cartesian/spherical-grids-structures-1"></a><a class="docs-heading-anchor-permalink" href="#Cartesian/spherical-grids-structures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.Grid2DCart" href="#EikonalSolvers.Grid2DCart"><code>EikonalSolvers.Grid2DCart</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Grid2DCart &lt;: EikonalSolvers.AbstractGridEik2D</code></pre><p>A structure holding the 2D grid parameters, geometry and size.</p><ul><li><p><code>hgrid::Float64</code>: Spacing of the grid nodes</p></li><li><p><code>cooinit::Tuple{Float64, Float64}</code>: Origin of the coodinates of the grid</p></li><li><p><code>cooend::Tuple{Float64, Float64}</code>: End of the coodinates of the grid</p></li><li><p><code>grsize::Tuple{Int64, Int64}</code>: Number of grid nodes along x and y</p></li><li><p><code>x::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: x coordinates of the grid nodes</p></li><li><p><code>y::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: y coordinates of the grid nodes</p></li></ul><p>The constructor requires three arguments (see the example):</p><ul><li><code>hgrid</code>: spacing of the grid nodes</li><li><code>cooinit</code>: origin of the coordinate system</li><li><code>grsize</code>: number of grid nodes along x and y</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Grid2DCart(hgrid=5.0,cooinit=(0.0,0.0),grsize=(300,250))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikstructs.jl#L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.Grid3DCart" href="#EikonalSolvers.Grid3DCart"><code>EikonalSolvers.Grid3DCart</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Grid3DCart &lt;: EikonalSolvers.AbstractGridEik3D</code></pre><p>A structure holding the 3D grid parameters, geometry and size.</p><p><strong>Fields</strong></p><ul><li><p><code>hgrid::Float64</code>: Spacing of the grid nodes</p></li><li><p><code>cooinit::Tuple{Float64, Float64, Float64}</code>: Origin of the coodinates of the grid</p></li><li><p><code>cooend::Tuple{Float64, Float64, Float64}</code>: End of the coodinates of the grid</p></li><li><p><code>grsize::Tuple{Int64, Int64, Int64}</code>: Number of grid nodes along x, y and z</p></li><li><p><code>x::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: x coordinates of the grid nodes</p></li><li><p><code>y::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: y coordinates of the grid nodes</p></li><li><p><code>z::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: z coordinates of the grid nodes</p></li></ul><p>The constructor requires three arguments (see the example):</p><ul><li><code>hgrid</code>: spacing of the grid nodes</li><li><code>cooinit</code>: origin of the coordinate system</li><li><code>grsize</code>: number of grid nodes along x, y and z</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Grid3DCart(hgrid=5.0,cooinit=(0.0,0.0,0.0),grsize=(60,60,40))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikstructs.jl#L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.Grid2DSphere" href="#EikonalSolvers.Grid2DSphere"><code>EikonalSolvers.Grid2DSphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A structure holding the 2D SPHERICAL grid parameters, geometry and size.</p><ul><li><p><code>Δr::Float64</code>: Spacing of the grid nodes along the radius (r)</p></li><li><p><code>Δθ::Float64</code>: Spacing of the grid nodes along the angle θ</p></li><li><p><code>cooinit::Tuple{Float64, Float64}</code>: Origin of the coodinates of the grid</p></li><li><p><code>cooend::Tuple{Float64, Float64}</code>: End of the coodinates of the grid</p></li><li><p><code>grsize::Tuple{Int64, Int64}</code>: Number of grid nodes along r and θ</p></li><li><p><code>r::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: r coordinates of the grid nodes</p></li><li><p><code>θ::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: θ coordinates of the grid nodes</p></li></ul><p>The fields are:    </p><ul><li><code>Δr</code>: spacing of the grid nodes along the radial coordinate r</li><li><code>Δθ</code>: spacing of the grid nodes along the θ coordinate</li><li><code>cooinit</code>: origin of the coordinate system</li><li><code>grsize</code>: number of grid nodes along r and θ </li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Grid2DSphere(Δr=15.0,Δθ=2.0,grsize=(10,15),cooinit=(500.0,0.0))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikstructs.jl#L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.Grid3DSphere" href="#EikonalSolvers.Grid3DSphere"><code>EikonalSolvers.Grid3DSphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A structure holding the 3D SPHERICAL grid parameters, geometry and size.</p><ul><li><p><code>Δr::Float64</code>: Spacing of the grid nodes along the radius (r)</p></li><li><p><code>Δθ::Float64</code>: Spacing of the grid nodes along the angle θ</p></li><li><p><code>Δφ::Float64</code>: Spacing of the grid nodes along the angle φ</p></li><li><p><code>cooinit::Tuple{Float64, Float64, Float64}</code>: Origin of the coodinates of the grid</p></li><li><p><code>cooend::Tuple{Float64, Float64, Float64}</code>: End of the coodinates of the grid</p></li><li><p><code>grsize::Tuple{Int64, Int64, Int64}</code>: Number of grid nodes along r, θ and φ</p></li><li><p><code>r::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: r coordinates of the grid nodes</p></li><li><p><code>θ::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: θ coordinates of the grid nodes</p></li><li><p><code>φ::StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}</code>: φ coordinates of the grid nodes</p></li></ul><p>The fields are:    </p><ul><li><code>Δr</code>: spacing of the grid nodes along the radial coordinate r</li><li><code>Δθ</code>: spacing of the grid nodes along the θ coordinate</li><li><code>Δφ</code>: spacing of the grid nodes along the θ coordinate</li><li><code>cooinit</code>: origin of the coordinate system</li><li><code>grsize</code>: number of grid nodes along r, θ and φ </li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Grid3DSphere(Δr=15.0,Δθ=2.0,Δφ=1.5,grsize=(10,15,12),cooinit=(500.0,20.0,0.0))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikstructs.jl#L163">source</a></section></article><h2 id="Forward,-gradient-and-misfit-calculation-functions"><a class="docs-heading-anchor" href="#Forward,-gradient-and-misfit-calculation-functions">Forward, gradient and misfit calculation functions</a><a id="Forward,-gradient-and-misfit-calculation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Forward,-gradient-and-misfit-calculation-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.eiktraveltime" href="#EikonalSolvers.eiktraveltime"><code>EikonalSolvers.eiktraveltime</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eiktraveltime(
    vel::Array{Float64, N},
    grd::EikonalSolvers.AbstractGridEik,
    coordsrc::Matrix{Float64},
    coordrec::Vector{Matrix{Float64}};
    returntt,
    extraparams
) -&gt; Any
</code></pre><p>Calculate the traveltime for 2D or 3D velocity models at requested receivers locations. Optionally return the array(s) of traveltime on the entire gridded model.</p><p><strong>Arguments</strong></p><ul><li><code>vel</code>: the 2D or 3D velocity model </li><li><code>grd</code>: a struct specifying the geometry and size of the model (e.g., Grid3DCart)</li><li><code>coordsrc</code>: the coordinates of the source(s) (x,y), a 2-column array </li><li><code>coordrec</code>: the coordinates of the receiver(s) (x,y) for each single source, a vector of 2-column arrays</li><li><code>returntt</code>: a boolean (default false) specifying whether to retur the array(s) of traveltime on the entire gridded model or not</li><li><code>extraparams</code> (optional): a struct containing some &quot;extra&quot; parameters, namely<ul><li><code>parallelkind</code>: serial, Threads or Distributed run? (:serial, :sharedmem, :distribmem)</li><li><code>refinearoundsrc</code>: whether to perform a refinement of the grid around the source location</li><li><code>grdrefpars</code>: refined grid around the source parameters (<code>downscalefactor</code> and <code>noderadius</code>)</li><li><code>radiussmoothgradsrc</code>: radius for smoothing each individual gradient <em>only</em> around the source. Zero means no smoothing.</li><li><code>smoothgradkern</code>: smooth the final gradient with a kernel of size <code>smoothgradkern</code> (in grid nodes). Zero means no smoothing.</li><li><code>manualGCtrigger</code>: trigger garbage collector (GC) manually at selected points.</li></ul></li></ul><p><strong>Returns</strong></p><ul><li>A vector of vectors containing traveltimes at the receivers for each source </li><li>If <code>returntt==true</code>, additionally returns the array(s) of traveltime on the entire gridded model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikmainfwd.jl#L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.eikgradient" href="#EikonalSolvers.eikgradient"><code>EikonalSolvers.eikgradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eikgradient(
    vel::Array{Float64, N},
    grd::EikonalSolvers.AbstractGridEik,
    coordsrc::Matrix{Float64},
    coordrec::Vector{Matrix{Float64}},
    pickobs::Vector{Vector{Float64}},
    stdobs::Vector{Vector{Float64}},
    whichgrad::Symbol;
    extraparams
) -&gt; Union{Nothing, Tuple{Any, Any}, Tuple{Any, Any, Any}}
</code></pre><p>Calculate the gradient of the misfit function w.r.t. either velocity or source location (or both) using the adjoint state method for 2D or 3D problems. </p><p>The computations may be run in parallel depending on the value of <code>extraparams.parallelkind</code>.</p><p><strong>Arguments</strong></p><ul><li><code>vel</code>: the 2D or 3D velocity model </li><li><code>grd</code>: a struct specifying the geometry and size of the model (e.g., Grid3DCart)</li><li><code>coordsrc</code>: the coordinates of the source(s) (x,y), a 2-column array </li><li><code>coordrec</code>: the coordinates of the receiver(s) (x,y) for each single source, a vector of 2-column arrays </li><li><code>pickobs</code>: observed traveltime picks</li><li><code>stdobs</code>: standard deviation of error on observed traveltime picks, an array with same shape than <code>pickobs</code></li><li><code>whichgrad</code>: one of :gradvel, :gradsrcloc, :gradvelandsrcloc, specifies which gradient should be computed</li><li><code>extraparams</code> (optional): a struct containing some &quot;extra&quot; parameters, namely<ul><li><code>parallelkind</code>: serial, Threads or Distributed run? (:serial, :sharedmem, :distribmem)</li><li><code>refinearoundsrc</code>: whether to perform a refinement of the grid around the source location</li><li><code>grdrefpars</code>: refined grid around the source parameters (<code>downscalefactor</code> and <code>noderadius</code>)</li><li><code>radiussmoothgradsrc</code>: radius for smoothing each individual gradient <em>only</em> around the source. Zero means no smoothing.</li><li><code>smoothgradkern</code>: smooth the final gradient with a kernel of size <code>smoothgradkern</code> (in grid nodes). Zero means no smoothing.</li><li><code>manualGCtrigger</code>: trigger garbage collector (GC) manually at selected points.</li></ul></li></ul><p><strong>Returns</strong></p><ul><li>The gradient w.r.t. velocity as a 2D or 3D array and the gradient w.r.t source location. In case only one of them is requested with <code>whichgrad</code>, the other one will not be returned.</li><li>The value of the misfit functional for the given input velocity model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikmaingrad.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.eikttimemisfit" href="#EikonalSolvers.eikttimemisfit"><code>EikonalSolvers.eikttimemisfit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eikttimemisfit(
    velmod::Array{Float64, N},
    grd::EikonalSolvers.AbstractGridEik,
    coordsrc::AbstractMatrix,
    coordrec::AbstractVector{&lt;:AbstractArray},
    ttpicksobs::AbstractArray,
    stdobs::AbstractArray;
    extraparams
) -&gt; Float64
</code></pre><p>Calculate the Gaussian misfit functional </p><p class="math-container">\[    S = \dfrac{1}{2} \sum_i \dfrac{\left( \mathbf{u}_i^{\rm{calc}}(\mathbf{v})-\mathbf{u}_i^{\rm{obs}} \right)^2}{\sigma_i^2} \, .\]</p><p><strong>Arguments</strong></p><ul><li><code>velmod</code>: velocity model, either a 2D or 3D array.</li><li><code>grd</code>: the struct holding the information about the grid, one of <code>Grid2D</code>,<code>Grid3D</code>,<code>Grid2Dsphere</code>,<code>Grid3Dsphere</code></li><li><code>coordsrc</code>: the coordinates of the source(s) (x,y), a 2-column array</li><li><code>coordrec</code>: the coordinates of the receiver(s) (x,y) for each single source, a vector of 2-column arrays</li><li><code>ttpicksobs</code>: a vector of vectors of the traveltimes at the receivers.</li><li><code>stdobs</code>: a vector of vectors standard deviations representing the error on the measured traveltimes.</li><li><code>extraparams</code> (optional): a struct containing some &quot;extra&quot; parameters, namely<ul><li><code>parallelkind</code>: serial, Threads or Distributed run? (:serial, :sharedmem, :distribmem)</li><li><code>refinearoundsrc</code>: whether to perform a refinement of the grid around the source location</li><li><code>grdrefpars</code>: refined grid around the source parameters (<code>downscalefactor</code> and <code>noderadius</code>)</li><li><code>manualGCtrigger</code>: trigger garbage collector (GC) manually at selected points.</li></ul></li></ul><p><strong>Returns</strong></p><p>The value of the misfit functional (L2-norm), the same used to compute the gradient with adjoint methods.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikmaingrad.jl#L1277">source</a></section></article><h2 id="Extra-parameters"><a class="docs-heading-anchor" href="#Extra-parameters">Extra parameters</a><a id="Extra-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Extra-parameters" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.ExtraParams" href="#EikonalSolvers.ExtraParams"><code>EikonalSolvers.ExtraParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ExtraParams</code></pre><p><strong>Fields</strong></p><ul><li><p><code>refinearoundsrc::Bool</code>: refine grid around source?</p></li><li><p><code>manualGCtrigger::Bool</code>: trigger GC manually at selected points</p></li><li><p><code>parallelkind::Symbol</code>: Serial, Threads or Distributed run? Either :serial, :sharedmem or :distribmem</p></li><li><p><code>radiussmoothgradsrc::Int64</code>: Radius for smoothing the gradient around the source. Zero means no smoothing.</p></li><li><p><code>smoothgradkern::Int64</code>: Smooth the gradient with a kernel of size (in pixels). Zero means no smoothing.</p></li><li><p><code>grdrefpars::GridRefinementPars</code>: Downscaling factor and node radius for refined grid creation</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikstructs.jl#L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.GridRefinementPars" href="#EikonalSolvers.GridRefinementPars"><code>EikonalSolvers.GridRefinementPars</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct GridRefinementPars</code></pre><p><strong>Fields</strong></p><ul><li><p><code>downscalefactor::Int64</code>: Downscaling factor for refined grid around the source</p></li><li><p><code>noderadius::Int64</code>: Number of (coarse) grid nodes (radius) within which to refine the grid</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikstructs.jl#L223">source</a></section></article><h2 id="Ray-tracing"><a class="docs-heading-anchor" href="#Ray-tracing">Ray tracing</a><a id="Ray-tracing-1"></a><a class="docs-heading-anchor-permalink" href="#Ray-tracing" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.tracerays" href="#EikonalSolvers.tracerays"><code>EikonalSolvers.tracerays</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tracerays(
    grd::EikonalSolvers.AbstractGridEik,
    ttime::Vector{Array{Float64}},
    coordsrc::Matrix{Float64},
    coordrec::Vector{Matrix{Float64}};
    steplen
) -&gt; Vector{Vector{Matrix{Float64}}}
</code></pre><p>Ray tracing utility. Given a traveltime grid and source and receiver positions, trace the rays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikSolv/eikutils.jl#L195-L200">source</a></section></article><h2 id="HMCsampler-wrapper"><a class="docs-heading-anchor" href="#HMCsampler-wrapper">HMCsampler wrapper</a><a id="HMCsampler-wrapper-1"></a><a class="docs-heading-anchor-permalink" href="#HMCsampler-wrapper" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.HMCtraveltimes" href="#EikonalSolvers.HMCtraveltimes"><code>EikonalSolvers.HMCtraveltimes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>HMCtraveltimes</p><p>A convenience module to facilitate the use of <code>EikonalSolvers</code> within the   framework of Hamiltonian Monte Carlo inversion by employing the package <code>HMCsampler</code>. </p><p><strong>Exports</strong></p><ul><li><a href="#EikonalSolvers.HMCtraveltimes.EikonalProbSrcLoc"><code>EikonalProbSrcLoc</code></a></li><li><a href="#EikonalSolvers.HMCtraveltimes.EikonalProbVel"><code>EikonalProbVel</code></a></li><li><a href="@ref"><code>EikonalProbVelAndSrcLoc</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/HMCtraveltimes.jl#L10-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.HMCtraveltimes.EikonalProbVel" href="#EikonalSolvers.HMCtraveltimes.EikonalProbVel"><code>EikonalSolvers.HMCtraveltimes.EikonalProbVel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EikonalProbVel</code></pre><p><strong>Fields</strong></p><ul><li><p><code>grd::Union{Grid2DCart, Grid3DCart}</code></p></li><li><p><code>dobs::Vector{Vector{Float64}}</code></p></li><li><p><code>stdobs::Vector{Vector{Float64}}</code></p></li><li><p><code>coordsrc::Matrix{Float64}</code></p></li><li><p><code>coordrec::Vector{Matrix{Float64}}</code></p></li><li><p><code>whichgrad::Symbol</code></p></li><li><p><code>logVel::Bool</code></p></li><li><p><code>extraparams::Union{Nothing, ExtraParams}</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/HMCtraveltimes.jl#L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.HMCtraveltimes.EikonalProbSrcLoc" href="#EikonalSolvers.HMCtraveltimes.EikonalProbSrcLoc"><code>EikonalSolvers.HMCtraveltimes.EikonalProbSrcLoc</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EikonalProbSrcLoc</code></pre><p><strong>Fields</strong></p><ul><li><p><code>grd::Union{Grid2DCart, Grid3DCart}</code></p></li><li><p><code>dobs::Vector{Vector{Float64}}</code></p></li><li><p><code>stdobs::Vector{Vector{Float64}}</code></p></li><li><p><code>coordrec::Vector{Matrix{Float64}}</code></p></li><li><p><code>velmod::Matrix{Float64}</code></p></li><li><p><code>whichgrad::Symbol</code></p></li><li><p><code>extraparams::Union{Nothing, ExtraParams}</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/HMCtraveltimes.jl#L119">source</a></section></article><h2 id="Extensions"><a class="docs-heading-anchor" href="#Extensions">Extensions</a><a id="Extensions-1"></a><a class="docs-heading-anchor-permalink" href="#Extensions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EikonalSolvers.savemodelvtk" href="#EikonalSolvers.savemodelvtk"><code>EikonalSolvers.savemodelvtk</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This function requires the package WriteVTK to be loaded first in order to work.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GinvLab/EikonalSolvers.jl/blob/4169e9296fdd7e1e43f9fca66f86c31d2cde552f/src/EikonalSolvers.jl#L87-L89">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../privatestuff/">Private stuff »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 3 February 2025 13:17">Monday 3 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
